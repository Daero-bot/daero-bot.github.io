<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FreshRescue</title>
    <link rel="icon" type="image/jpg" href="https://i.ibb.co/5xKBLzy0/generated-image-5.jpg">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #228B22 0%, #90EE90 50%, #98FB98 100%);
            min-height: 100vh;
            color: #333;
            overflow-x: hidden;
            line-height: 1.6;
        }

        /* Header mejorado */
        header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            padding: 1.5rem 2rem;
            text-align: center;
            box-shadow: 0 10px 40px rgba(0,0,0,0.15);
            position: sticky;
            top: 0;
            z-index: 100;
            animation: slideDown 0.8s ease-out;
            position: relative;
        }

        /* Cr√©ditos esquina superior derecha */
        .creditos {
            position: absolute;
            top: 1.5rem;
            right: 2rem;
            background: rgba(255,255,255,0.9);
            backdrop-filter: blur(15px);
            padding: 0.8rem 1.2rem;
            border-radius: 20px;
            font-size: 0.85rem;
            color: #666;
            font-weight: 400;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            border: 1px solid rgba(255,255,255,0.3);
            max-width: 280px;
            text-align: right;
            line-height: 1.4;
        }

        .creditos strong {
            color: #228B22;
            font-weight: 600;
            display: block;
            margin-bottom: 0.2rem;
        }

        @keyframes slideDown {
            from { transform: translateY(-100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        #logo {
            width: 90px;
            height: 90px;
            margin-bottom: 1rem;
            border-radius: 50%;
            box-shadow: 0 15px 40px rgba(34,139,34,0.5);
            transition: all 0.4s ease;
        }

        #logo:hover {
            transform: scale(1.1) rotate(5deg);
        }

        h1 {
            color: #228B22;
            font-size: 2.8rem;
            font-weight: 700;
            margin: 0;
            text-shadow: 2px 2px 6px rgba(0,0,0,0.1);
        }

        /* Contenedor principal con grid para rellenar lados */
        .main-container {
            display: grid;
            grid-template-columns: 300px 1fr 300px;
            gap: 2rem;
            max-width: 1600px;
            margin: 2rem auto;
            padding: 0 1rem;
        }

        /* Sidebar izquierda: Mapa y filtros */
        .sidebar-left {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(15px);
            border-radius: 25px;
            padding: 2rem;
            box-shadow: 0 15px 50px rgba(0,0,0,0.2);
            height: fit-content;
        }

        #map {
            width: 100%;
            height: 350px;
            border-radius: 20px;
            margin-bottom: 1.5rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .filtros {
            font-size: 0.95rem;
        }

        .filtros h3 {
            color: #228B22;
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }

        .filtro-group {
            margin-bottom: 1rem;
        }

        .filtro-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: #555;
            font-weight: 500;
        }

        .filtro-group select, .filtro-group input {
            width: 100%;
            padding: 0.8rem;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-family: inherit;
            transition: border-color 0.3s;
        }

        .filtro-group select:focus, .filtro-group input:focus {
            outline: none;
            border-color: #FF8C00;
        }

        /* ‚≠ê NUEVO: Estilos para el slider de precio */
        .precio-slider-container {
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }

        .precio-slider {
            flex: 1;
            height: 6px;
            border-radius: 3px;
            background: #e0e0e0;
            outline: none;
            -webkit-appearance: none;
            appearance: none;
        }

        .precio-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: linear-gradient(135deg, #FF8C00, #FFA500);
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(255,140,0,0.4);
            transition: all 0.3s ease;
        }

        .precio-slider::-webkit-slider-thumb:hover {
            transform: scale(1.2);
            box-shadow: 0 6px 16px rgba(255,140,0,0.6);
        }

        .precio-slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: linear-gradient(135deg, #FF8C00, #FFA500);
            cursor: pointer;
            border: none;
            box-shadow: 0 4px 12px rgba(255,140,0,0.4);
        }

        .precio-value {
            font-weight: 600;
            color: #FF8C00;
            font-size: 1.1rem;
            min-width: 50px;
            text-align: center;
        }

        /* Ocultar ofertas */
        .oferta.oculta {
            display: none;
        }

        /* Contenido central: Ofertas */
        .ofertas-central {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .ofertas {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
        }

        .oferta {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            padding: 2rem;
            border-radius: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            display: flex;
            gap: 1.5rem;
            position: relative;
            overflow: hidden;
        }

        .oferta::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: linear-gradient(90deg, #FF8C00, #FFA500, #FF8C00);
        }

        .oferta:hover {
            transform: translateY(-15px) scale(1.02);
            box-shadow: 0 30px 80px rgba(0,0,0,0.25);
        }

        .oferta img {
            width: 120px;
            height: 120px;
            border-radius: 25px;
            object-fit: cover;
            box-shadow: 0 12px 35px rgba(0,0,0,0.2);
            transition: transform 0.4s ease;
        }

        .oferta:hover img {
            transform: scale(1.1);
        }

        .info {
            flex: 1;
        }

        .negocio {
            font-weight: 600;
            color: #228B22;
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
        }

        .descripcion {
            font-size: 1.3rem;
            margin-bottom: 0.8rem;
            color: #333;
            font-weight: 500;
        }

        .precio {
            font-size: 2.2rem;
            color: #FF8C00;
            font-weight: 700;
            margin: 1rem 0;
        }

        .precio span {
            font-size: 0.55em;
            color: #666;
            font-weight: 400;
            text-decoration: line-through;
            margin-left: 1rem;
        }

        .caduca {
            color: #FF6B35;
            font-size: 1.1rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .btn {
            background: linear-gradient(135deg, #FF8C00, #FFA500);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 1rem;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            box-shadow: 0 10px 30px rgba(255,140,0,0.4);
            position: relative;
            overflow: hidden;
        }

        .btn:hover {
            transform: translateY(-4px);
            box-shadow: 0 15px 40px rgba(255,140,0,0.6);
        }

        .btn:active {
            transform: translateY(-2px);
        }

        /* Sidebar derecha: Stats y CTA */
        .sidebar-right {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(15px);
            border-radius: 25px;
            padding: 2rem;
            box-shadow: 0 15px 50px rgba(0,0,0,0.2);
            height: fit-content;
        }

        .stats {
            text-align: center;
            margin-bottom: 2rem;
        }

        .stat {
            display: inline-block;
            background: linear-gradient(135deg, #228B22, #90EE90);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 20px;
            margin: 0 0.5rem;
            font-weight: 600;
            box-shadow: 0 8px 25px rgba(34,139,34,0.4);
        }

        .cta {
            text-align: center;
        }

        .cta h3 {
            color: #228B22;
            margin-bottom: 1rem;
        }

        /* Footer */
        footer {
            text-align: center;
            padding: 4rem 2rem 2rem;
            background: rgba(34,139,34,0.95);
            color: white;
            margin-top: 4rem;
            font-weight: 300;
        }

        /* Redes Sociales */
        .redes-sociales {
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 2px solid rgba(255,255,255,0.3);
        }

        .redes-sociales h3 {
            font-size: 1.3rem;
            margin-bottom: 1.5rem;
            color: #fff;
            font-weight: 600;
        }

        .redes-icons {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            flex-wrap: wrap;
        }

        .red-social {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-decoration: none;
            color: white;
            transition: all 0.3s ease;
            padding: 1rem;
            border-radius: 20px;
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255,255,255,0.2);
        }

        .red-social:hover {
            transform: translateY(-8px) scale(1.1);
            background: rgba(255,140,0,0.2);
            border-color: #FF8C00;
            box-shadow: 0 15px 40px rgba(255,140,0,0.3);
        }

        .red-social i {
            font-size: 2.2rem;
            margin-bottom: 0.5rem;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .main-container {
                grid-template-columns: 1fr;
                max-width: 1000px;
            }
            .sidebar-left, .sidebar-right {
                order: 3;
            }
        }

        @media (max-width: 768px) {
            .creditos {
                position: relative;
                top: auto;
                right: auto;
                margin: 1rem auto 0;
                max-width: 100%;
                text-align: center;
            }
            
            h1 { font-size: 2.2rem; }
            .ofertas { grid-template-columns: 1fr; }
            .oferta { flex-direction: column; text-align: center; }
            header { padding: 1rem; }
            .redes-icons { gap: 1rem; }
            .red-social i { font-size: 2rem; }
            .precio-slider-container { flex-direction: column; gap: 0.5rem; align-items: stretch; }
        }

        /* ===== MODALES CENTRADOS ===== */
        .modal-base {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: min(920px, 95vw);
            max-height: 90vh;
            max-width: 95vw;
            border: none;
            border-radius: 26px;
            padding: 0;
            overflow: hidden;
            box-shadow: 0 30px 90px rgba(0,0,0,0.35);
            margin: 0;
            background: rgba(255,255,255,0.98);
        }

        .modal-base::backdrop {
            background: rgba(0,0,0,0.55);
            backdrop-filter: blur(6px);
        }

        .modal-base[open] {
            animation: modalIn 180ms ease-out;
        }

        @keyframes modalIn {
            from { 
                transform: translate(-50%, -60%) scale(0.98); 
                opacity: 0; 
            }
            to { 
                transform: translate(-50%, -50%) scale(1); 
                opacity: 1; 
            }
        }

        .modal-close {
            position: absolute;
            top: 14px;
            right: 14px;
            width: 44px;
            height: 44px;
            border-radius: 14px;
            border: 2px solid rgba(0,0,0,0.08);
            background: rgba(255,255,255,0.9);
            cursor: pointer;
            font-size: 28px;
            line-height: 38px;
            z-index: 1000;
        }

        /* MODAL RESCATE 1 */
        .modal-rescate .modal-grid {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 0;
            height: 100%;
            min-height: 400px;
        }

        .modal-rescate .modal-img {
            width: 100%;
            height: 100%;
            min-height: 320px;
            object-fit: cover;
        }

        .modal-rescate .modal-info {
            padding: 2rem;
        }

        .modal-rescate .modal-negocio {
            font-weight: 600;
            color: #228B22;
            margin-bottom: 0.3rem;
        }

        .modal-rescate .modal-titulo {
            margin: 0 0 0.8rem 0;
            color: #222;
        }

        .modal-rescate .modal-precio {
            font-size: 2.1rem;
            color: #FF8C00;
            font-weight: 700;
            margin: 0.7rem 0 0.4rem;
        }

        .modal-rescate .modal-precio span {
            font-size: 0.55em;
            color: #666;
            font-weight: 400;
            text-decoration: line-through;
            margin-left: 0.8rem;
        }

        .modal-rescate .modal-caduca {
            color: #FF6B35;
            font-weight: 500;
            margin-bottom: 0.8rem;
        }

        .modal-rescate .modal-desc {
            color: #444;
            margin: 0.6rem 0 1.4rem;
        }

        .modal-rescate .modal-actions {
            display: flex;
            gap: 0.8rem;
            flex-wrap: wrap;
        }

        /* MODAL FORMULARIO 2 */
        .modal-formulario {
            max-width: 500px;
            max-height: 70vh;
        }

        .modal-formulario .modal-content {
            padding: 2.5rem;
            max-height: 70vh;
            overflow-y: auto;
        }

        .modal-formulario h2 {
            color: #228B22;
            margin-bottom: 1.5rem;
            font-size: 1.8rem;
            text-align: center;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: #333;
            font-weight: 600;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 1rem;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-family: inherit;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #FF8C00;
            box-shadow: 0 0 0 3px rgba(255,140,0,0.1);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 80px;
        }

        .modal-formulario .modal-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
            padding-top: 1.5rem;
            border-top: 1px solid #eee;
            margin-top: 1.5rem;
        }

        .btn.btn-secondary {
            background: linear-gradient(135deg, #777, #999);
            box-shadow: 0 10px 30px rgba(0,0,0,0.18);
        }

        /* NUEVO MODAL DESCARGAR APP */
        .modal-descargar {
            max-width: 450px;
            text-align: center;
        }

        .modal-descargar .modal-content {
            padding: 3rem 2.5rem 2.5rem;
        }

        .modal-descargar .modal-icon {
            font-size: 4rem;
            color: #FF8C00;
            margin-bottom: 1.5rem;
        }

        .modal-descargar h2 {
            color: #228B22;
            margin-bottom: 1rem;
            font-size: 1.6rem;
        }

        .modal-descargar .modal-texto {
            color: #555;
            font-size: 1.1rem;
            margin-bottom: 2rem;
            line-height: 1.5;
        }

        /* Responsive modales */
        @media (max-width: 720px) {
            .modal-rescate .modal-grid { 
                grid-template-columns: 1fr; 
                min-height: 500px;
            }
            .modal-rescate .modal-img { 
                min-height: 220px; 
                height: 220px;
            }
            .modal-formulario .modal-content {
                padding: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <header>
        <!-- CR√âDITOS SUPERIOR DERECHA -->
        <div class="creditos">
            <strong>Prototipo InnovaFood</strong><br>
            Juan Daniel Porras, Pablo Racero e Isaac Laynez<br>
            <small>1¬∫ SMR IES Salmedina</small>
        </div>
        
        <img src="https://i.ibb.co/5xKBLzy0/generated-image-5.jpg" alt="FreshRescue Logo" id="logo">
        <h1>FreshRescue</h1>
        <p>Rescata comida fresca de locales antes de que caduque</p>
    </header>

    <div class="main-container">
        <!-- Sidebar izquierda -->
        <div class="sidebar-left">
            <div id="map"></div>
            <div class="filtros">
                <h3><i class="fas fa-filter"></i> Filtros</h3>
                <div class="filtro-group">
                    <label>Distancia</label>
                    <select>
                        <option>Todo cerca (5km)</option>
                        <option>10km</option>
                        <option>20km</option>
                    </select>
                </div>
                <div class="filtro-group">
                    <label>Categor√≠a</label>
                    <select>
                        <option>Todas</option>
                        <option>Panader√≠a</option>
                        <option>Restaurante</option>
                        <option>Fruter√≠a</option>
                    </select>
                </div>
                <!-- ‚≠ê SLIDER DE PRECIO FUNCIONAL -->
                <div class="filtro-group">
                    <label>Precio m√°x.</label>
                    <div class="precio-slider-container">
                        <input type="range" class="precio-slider" id="precioMax" min="0" max="20" value="10" step="0.5">
                        <span class="precio-value" id="precioValue">‚Ç¨10</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Contenido central -->
        <div class="ofertas-central">
            <div class="ofertas" id="ofertasContainer">
                <!-- ‚≠ê OFERTAS CON DATA-PRECIOS -->
                <div class="oferta" data-precio="2.50"
                     data-direccion="C/ Panaderos 3, Chipiona"
                     data-recogida="Recogida hoy 19:00‚Äì20:00"
                     data-extra="Incluye 6 croissants; puede contener frutos secos.">
                   <img src="https://img.freepik.com/foto-gratis/croissants-tabla-cortar-madera_1150-28480.jpg?sem=taish3_w=740&fit=crop&auto=format&w=740&q=80" alt="Croissants">
                   <div class="info">
                       <div class="negocio">Panader√≠a La Esquina</div>
                       <h3>Croissants frescos (pack 6u)</h3>
                       <div class="precio">‚Ç¨2.50 <span>antes ‚Ç¨6</span></div>
                       <div class="caduca"><i class="fas fa-clock"></i> Caduca en 2h 40m</div>
                       <button class="btn">¬°Rescatar!</button>
                   </div>
                </div>

                <div class="oferta" data-precio="8.00"
                     data-direccion="Av. del Puerto 15, Chipiona"
                     data-recogida="Recogida hoy 14:30‚Äì15:00"
                     data-extra="Raci√≥n para 2 personas; puede contener marisco.">
                   <img src="https://images.immediate.co.uk/production/volatile/sites/30/2020/08/paella-837f12c.jpg" alt="Paella">
                   <div class="info">
                       <div class="negocio">Restaurante El Puerto</div>
                       <h3>Paella mixta (2 pax)</h3>
                       <div class="precio">‚Ç¨8.00 <span>antes ‚Ç¨18</span></div>
                       <div class="caduca"><i class="fas fa-clock"></i> Caduca en 1h 30m</div>
                       <button class="btn">¬°Rescatar!</button>
                   </div>
                </div>

                <div class="oferta" data-precio="3.00"
                     data-direccion="C/ Mercado 1, Chipiona"
                     data-recogida="Recogida hoy 20:00‚Äì21:00"
                     data-extra="Caja sorpresa con fruta variada de temporada.">
                   <img src="https://i.ibb.co/kgzNK4yT/CAJA-FRUTA-scaled.jpg" alt="Fruta">
                   <div class="info">
                       <div class="negocio">Fruteria Pepe</div>
                       <h3>Fruta variada (caja)</h3>
                       <div class="precio">‚Ç¨3.00 <span>antes ‚Ç¨9</span></div>
                       <div class="caduca"><i class="fas fa-clock"></i> Caduca en 3h 20m</div>
                       <button class="btn">¬°Rescatar!</button>
                   </div>
                </div>
            </div>
        </div>

        <!-- Sidebar derecha -->
        <div class="sidebar-right">
            <div class="stats">
                <div class="stat"><i class="fas fa-leaf"></i> 150kg salvados</div>
                <div class="stat"><i class="fas fa-users"></i> 2.5k usuarios</div>
                <div class="stat"><i class="fas fa-euro-sign"></i> ‚Ç¨45k ahorrados</div>
            </div>
            <div class="cta">
                <h3>¬°√önete ya!</h3>
                <p>Descarga la app y rescata comida cerca de Chipiona.</p>
                <button class="btn descargar-btn" style="width: 100%;">Descargar App</button>
            </div>
        </div>
    </div>

    <footer>
        <p>Tu app de comida sostenible <i class="fas fa-leaf"></i></p>
        <div class="redes-sociales">
            <h3>¬°S√≠guenos en nuestras redes sociales!</h3>
            <div class="redes-icons">
                <a href="https://instagram.com/freshrescue" target="_blank" class="red-social" title="Instagram">
                    <i class="fab fa-instagram"></i>
                    <span>Instagram</span>
                </a>
                <a href="https://facebook.com/freshrescue" target="_blank" class="red-social" title="Facebook">
                    <i class="fab fa-facebook-f"></i>
                    <span>Facebook</span>
                </a>
                <a href="https://twitter.com/freshrescue" target="_blank" class="red-social" title="Twitter">
                    <i class="fab fa-twitter"></i>
                    <span>Twitter</span>
                </a>
                <a href="https://tiktok.com/@freshrescue" target="_blank" class="red-social" title="TikTok">
                    <i class="fab fa-tiktok"></i>
                    <span>TikTok</span>
                </a>
                <a href="https://youtube.com/freshrescue" target="_blank" class="red-social" title="YouTube">
                    <i class="fab fa-youtube"></i>
                    <span>YouTube</span>
                </a>
            </div>
        </div>
    </footer>

    <!-- MODAL 1: RESCATE -->
    <dialog id="rescateModal" class="modal-base modal-rescate" aria-labelledby="rescateTitulo" aria-describedby="rescateDesc">
        <button class="modal-close" id="modalCloseBtn1" aria-label="Cerrar">√ó</button>

        <div class="modal-grid">
            <img id="modalImg" class="modal-img" src="" alt="">

            <div class="modal-info">
                <div id="modalNegocio" class="modal-negocio"></div>
                <h2 id="rescateTitulo" class="modal-titulo"></h2>

                <div id="modalPrecio" class="modal-precio"></div>
                <div id="modalCaduca" class="modal-caduca"></div>

                <p id="rescateDesc" class="modal-desc"></p>

                <div class="modal-actions">
                    <button class="btn" id="confirmRescate">Confirmar rescate</button>
                    <button class="btn btn-secondary" id="cancelRescate1">Cancelar</button>
                </div>
            </div>
        </div>
    </dialog>

    <!-- MODAL 2: FORMULARIO DE DATOS -->
    <dialog id="formularioModal" class="modal-base modal-formulario">
        <button class="modal-close" id="modalCloseBtn2" aria-label="Cerrar">√ó</button>

        <div class="modal-content">
            <h2><i class="fas fa-user"></i> Completa tus datos</h2>
            
            <form id="rescateForm">
                <div class="form-group">
                    <label for="nombre">Nombre completo</label>
                    <input type="text" id="nombre" required>
                </div>
                
                <div class="form-group">
                    <label for="telefono">Tel√©fono</label>
                    <input type="tel" id="telefono" required>
                </div>
                
                <div class="form-group">
                    <label for="direccion">Direcci√≥n de entrega</label>
                    <input type="text" id="direccion" placeholder="Calle, N√∫mero, Ciudad" required>
                </div>
                
                <div class="form-group">
                    <label for="notas">Notas especiales</label>
                    <textarea id="notas" placeholder="Alergias, preferencias, etc..."></textarea>
                </div>
                
                <div class="form-group">
                    <label for="hora">Hora preferida</label>
                    <select id="hora">
                        <option>Lo antes posible</option>
                        <option>En 30 min</option>
                        <option>En 1 hora</option>
                        <option>En 2 horas</option>
                    </select>
                </div>
            </form>

            <div class="modal-actions">
                <button class="btn btn-secondary" id="cancelRescate2">Cancelar</button>
                <button class="btn" id="aceptarRescate">Aceptar</button>
            </div>
        </div>
    </dialog>

    <!-- NUEVO MODAL 3: DESCARGAR APP -->
    <dialog id="descargarModal" class="modal-base modal-descargar">
        <button class="modal-close" id="modalCloseBtn3" aria-label="Cerrar">√ó</button>
        
        <div class="modal-content">
            <div class="modal-icon">
                <i class="fas fa-download"></i>
            </div>
            <h2>App en desarrollo</h2>
            <p class="modal-texto">La aplicaci√≥n todav√≠a no est√° disponible, muchas gracias</p>
            <div class="modal-actions">
                <button class="btn btn-secondary" id="cerrarDescargar">Entendido</button>
            </div>
        </div>
    </dialog>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // Mapa
        const map = L.map('map').setView([36.7333, -6.4333], 13);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>'
        }).addTo(map);

        L.marker([36.7333, -6.4333]).addTo(map).bindPopup('¬°Est√°s aqu√≠! Ofertas cerca.');
        L.marker([36.735, -6.435]).addTo(map).bindPopup('Panader√≠a La Esquina');

        // ‚≠ê FUNCIONALIDAD SLIDER DE PRECIO
        const precioSlider = document.getElementById('precioMax');
        const precioValue = document.getElementById('precioValue');
        const ofertasContainer = document.getElementById('ofertasContainer');
        let precioMaximo = parseFloat(precioSlider.value);

        // Funci√≥n para actualizar el valor mostrado
        function actualizarPrecioValue() {
            const valor = parseFloat(precioSlider.value);
            precioValue.textContent = `‚Ç¨${valor.toFixed(2)}`;
            precioMaximo = valor;
            filtrarOfertas();
        }

        // Funci√≥n para filtrar ofertas por precio
        function filtrarOfertas() {
            const ofertas = ofertasContainer.querySelectorAll('.oferta');
            let visibles = 0;

            ofertas.forEach(oferta => {
                const precioOferta = parseFloat(oferta.dataset.precio);
                if (precioOferta <= precioMaximo) {
                    oferta.classList.remove('oculta');
                    visibles++;
                } else {
                    oferta.classList.add('oculta');
                }
            });

            // Mensaje si no hay ofertas
            if (visibles === 0) {
                ofertasContainer.innerHTML += `
                    <div style="grid-column: 1/-1; text-align: center; padding: 3rem; color: #666; font-size: 1.2rem;">
                        <i class="fas fa-search" style="font-size: 3rem; margin-bottom: 1rem; color: #FF8C00;"></i>
                        <p>No hay ofertas en este rango de precio</p>
                        <p>Prueba con un precio m√°ximo m√°s alto</p>
                    </div>
                `;
            } else {
                // Remover mensaje si hay ofertas
                const mensajeNoOfertas = ofertasContainer.querySelector('div[style*="grid-column"]');
                if (mensajeNoOfertas) {
                    mensajeNoOfertas.remove();
                }
            }
        }

        // Eventos del slider
        precioSlider.addEventListener('input', actualizarPrecioValue);
        precioSlider.addEventListener('change', actualizarPrecioValue);

        // Modales
        const rescateDialog = document.getElementById('rescateModal');
        const formularioDialog = document.getElementById('formularioModal');
        const descargarDialog = document.getElementById('descargarModal');
        
        const modalImg = document.getElementById('modalImg');
        const modalNegocio = document.getElementById('modalNegocio');
        const modalTitulo = document.getElementById('rescateTitulo');
        const modalPrecio = document.getElementById('modalPrecio');
        const modalCaduca = document.getElementById('modalCaduca');
        const modalDesc = document.getElementById('rescateDesc');

        // Botones cerrar
        const modalCloseBtn1 = document.getElementById('modalCloseBtn1');
        const modalCloseBtn2 = document.getElementById('modalCloseBtn2');
        const modalCloseBtn3 = document.getElementById('modalCloseBtn3');
        const cancelRescate1 = document.getElementById('cancelRescate1');
        const cancelRescate2 = document.getElementById('cancelRescate2');
        const cerrarDescargar = document.getElementById('cerrarDescargar');

        // ‚≠ê NUEVA FUNCIONALIDAD: Bot√≥n Descargar App
        document.querySelector('.descargar-btn').addEventListener('click', () => {
            descargarDialog.showModal();
            modalCloseBtn3.focus();
        });

        // L√≥gica primer modal (Rescate)
        document.querySelectorAll('.oferta .btn').forEach((btn) => {
            btn.addEventListener('click', (e) => {
                const card = e.currentTarget.closest('.oferta');
                if (!card) return;

                const img = card.querySelector('img');
                const negocio = card.querySelector('.negocio')?.textContent?.trim() || 'Local';
                const titulo = card.querySelector('h3')?.textContent?.trim() || 'Oferta';
                const precioHTML = card.querySelector('.precio')?.innerHTML || '';
                const caduca = card.querySelector('.caduca')?.textContent?.trim() || '';

                modalImg.src = img?.src || '';
                modalImg.alt = img?.alt || 'Foto de la oferta';
                modalNegocio.textContent = negocio;
                modalTitulo.textContent = titulo;
                modalPrecio.innerHTML = precioHTML;
                modalCaduca.textContent = caduca;

                const direccion = card.dataset.direccion;
                const recogida = card.dataset.recogida;
                const extra = card.dataset.extra;

                modalDesc.textContent =
                    (direccion ? `üìç ${direccion}. ` : '') +
                    (recogida ? `üïí ${recogida}. ` : '') +
                    (extra ? extra : '');

                rescateDialog.showModal();
                modalCloseBtn1.focus();
            });
        });

        // Abrir segundo modal desde "Confirmar rescate"
        document.getElementById('confirmRescate').addEventListener('click', () => {
            rescateDialog.close();
            formularioDialog.showModal();
            document.getElementById('nombre').focus();
        });

        // Cerrar modales
        function cerrarModal1() { if (rescateDialog.open) rescateDialog.close(); }
        function cerrarModal2() { if (formularioDialog.open) formularioDialog.close(); }
        function cerrarModal3() { if (descargarDialog.open) descargarDialog.close(); }

        modalCloseBtn1.addEventListener('click', cerrarModal1);
        cancelRescate1.addEventListener('click', cerrarModal1);
        modalCloseBtn2.addEventListener('click', cerrarModal2);
        cancelRescate2.addEventListener('click', cerrarModal2);
        modalCloseBtn3.addEventListener('click', cerrarModal3);
        cerrarDescargar.addEventListener('click', cerrarModal3);

        // Click fuera para cerrar
        rescateDialog.addEventListener('click', (e) => { if (e.target === rescateDialog) cerrarModal1(); });
        formularioDialog.addEventListener('click', (e) => { if (e.target === formularioDialog) cerrarModal2(); });
        descargarDialog.addEventListener('click', (e) => { if (e.target === descargarDialog) cerrarModal3(); });

        // Acci√≥n final "Aceptar"
        document.getElementById('aceptarRescate').addEventListener('click', () => {
            formularioDialog.close();
            alert('¬°Rescate confirmado! üòä\n\nTu pedido est√° en proceso. Recibir√°s confirmaci√≥n por WhatsApp.');
        });

        console.log('FreshRescue Prototipo InnovaFood üöÄ - 1¬∫ SMR IES Salmedina - Filtro de precio FUNCIONAL ‚úÖ');
    </script>
</body>
</html>
